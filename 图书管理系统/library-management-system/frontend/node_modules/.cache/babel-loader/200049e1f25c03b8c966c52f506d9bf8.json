{"ast":null,"code":"var _jsxFileName = \"D:\\\\\\u6591\\u9A6C\\\\\\u524D\\u7AEFts\\\\library-management-system\\\\library-management-system\\\\frontend\\\\src\\\\context\\\\user-context.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { useState, useEffect, createContext, useContext } from \"react\";\nimport { NotificationManager } from \"react-notifications\";\nimport { BackendApi } from \"../client/backend-api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst UserContext = /*#__PURE__*/createContext({\n  user: null,\n  loginUser: () => {}\n});\n\nconst useUser = () => {\n  _s();\n\n  return useContext(UserContext);\n};\n\n_s(useUser, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nconst UserProvider = _ref => {\n  _s2();\n\n  let {\n    children\n  } = _ref;\n  const [user, setUser] = useState(null);\n  const [isAdmin, setIsAdmin] = useState(false);\n  useEffect(() => {\n    setIsAdmin(user && user.role === 'admin');\n  }, [user]);\n  useEffect(() => {\n    BackendApi.user.getProfile().then(_ref2 => {\n      let {\n        user,\n        error\n      } = _ref2;\n\n      if (error) {\n        console.error(error);\n      } else {\n        setUser(user);\n      }\n    }).catch(console.error);\n  }, []);\n\n  const loginUser = async (username, password) => {\n    const {\n      user,\n      error\n    } = await BackendApi.user.login(username, password);\n\n    if (error) {\n      NotificationManager.error(error);\n    } else {\n      NotificationManager.success(\"Logged in successfully\");\n      setUser(user);\n    }\n  };\n\n  const logoutUser = async () => {\n    setUser(null);\n    await BackendApi.user.logout();\n  };\n\n  return /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n    value: {\n      user,\n      loginUser,\n      logoutUser,\n      isAdmin\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 46,\n    columnNumber: 9\n  }, this);\n};\n\n_s2(UserProvider, \"ZAv6yXF2iYQpawfQav3dTN36vmw=\");\n\n_c = UserProvider;\nexport { useUser, UserProvider };\n\nvar _c;\n\n$RefreshReg$(_c, \"UserProvider\");","map":{"version":3,"names":["useState","useEffect","createContext","useContext","NotificationManager","BackendApi","UserContext","user","loginUser","useUser","UserProvider","children","setUser","isAdmin","setIsAdmin","role","getProfile","then","error","console","catch","username","password","login","success","logoutUser","logout"],"sources":["D:/斑马/前端ts/library-management-system/library-management-system/frontend/src/context/user-context.js"],"sourcesContent":["import { useState, useEffect, createContext, useContext } from \"react\"\nimport { NotificationManager } from \"react-notifications\"\nimport { BackendApi } from \"../client/backend-api\"\n\nconst UserContext = createContext({\n    user: null,\n    loginUser: () => { },\n})\n\nconst useUser = () => useContext(UserContext);\n\nconst UserProvider = ({ children }) => {\n    const [user, setUser] = useState(null);\n    const [isAdmin, setIsAdmin] = useState(false);\n\n    useEffect(() => {\n        setIsAdmin(user && user.role === 'admin')\n    }, [user])\n\n    useEffect(() => {\n        BackendApi.user.getProfile().then(({ user, error }) => {\n            if (error) {\n                console.error(error)\n            } else {\n                setUser(user)\n            }\n        }).catch(console.error)\n    }, [])\n\n    const loginUser = async (username, password) => {\n        const { user, error } = await BackendApi.user.login(username, password)\n        if (error) {\n            NotificationManager.error(error)\n        } else {\n            NotificationManager.success(\"Logged in successfully\")\n            setUser(user)\n        }\n    }\n\n    const logoutUser = async () => {\n        setUser(null)\n        await BackendApi.user.logout()\n    }\n\n    return (\n        <UserContext.Provider value={{ user, loginUser, logoutUser, isAdmin }}>\n            {children}\n        </UserContext.Provider>\n    )\n}\n\nexport { useUser, UserProvider }"],"mappings":";;;;AAAA,SAASA,QAAT,EAAmBC,SAAnB,EAA8BC,aAA9B,EAA6CC,UAA7C,QAA+D,OAA/D;AACA,SAASC,mBAAT,QAAoC,qBAApC;AACA,SAASC,UAAT,QAA2B,uBAA3B;;AAEA,MAAMC,WAAW,gBAAGJ,aAAa,CAAC;EAC9BK,IAAI,EAAE,IADwB;EAE9BC,SAAS,EAAE,MAAM,CAAG;AAFU,CAAD,CAAjC;;AAKA,MAAMC,OAAO,GAAG;EAAA;;EAAA,OAAMN,UAAU,CAACG,WAAD,CAAhB;AAAA,CAAhB;;GAAMG,O;;AAEN,MAAMC,YAAY,GAAG,QAAkB;EAAA;;EAAA,IAAjB;IAAEC;EAAF,CAAiB;EACnC,MAAM,CAACJ,IAAD,EAAOK,OAAP,IAAkBZ,QAAQ,CAAC,IAAD,CAAhC;EACA,MAAM,CAACa,OAAD,EAAUC,UAAV,IAAwBd,QAAQ,CAAC,KAAD,CAAtC;EAEAC,SAAS,CAAC,MAAM;IACZa,UAAU,CAACP,IAAI,IAAIA,IAAI,CAACQ,IAAL,KAAc,OAAvB,CAAV;EACH,CAFQ,EAEN,CAACR,IAAD,CAFM,CAAT;EAIAN,SAAS,CAAC,MAAM;IACZI,UAAU,CAACE,IAAX,CAAgBS,UAAhB,GAA6BC,IAA7B,CAAkC,SAAqB;MAAA,IAApB;QAAEV,IAAF;QAAQW;MAAR,CAAoB;;MACnD,IAAIA,KAAJ,EAAW;QACPC,OAAO,CAACD,KAAR,CAAcA,KAAd;MACH,CAFD,MAEO;QACHN,OAAO,CAACL,IAAD,CAAP;MACH;IACJ,CAND,EAMGa,KANH,CAMSD,OAAO,CAACD,KANjB;EAOH,CARQ,EAQN,EARM,CAAT;;EAUA,MAAMV,SAAS,GAAG,OAAOa,QAAP,EAAiBC,QAAjB,KAA8B;IAC5C,MAAM;MAAEf,IAAF;MAAQW;IAAR,IAAkB,MAAMb,UAAU,CAACE,IAAX,CAAgBgB,KAAhB,CAAsBF,QAAtB,EAAgCC,QAAhC,CAA9B;;IACA,IAAIJ,KAAJ,EAAW;MACPd,mBAAmB,CAACc,KAApB,CAA0BA,KAA1B;IACH,CAFD,MAEO;MACHd,mBAAmB,CAACoB,OAApB,CAA4B,wBAA5B;MACAZ,OAAO,CAACL,IAAD,CAAP;IACH;EACJ,CARD;;EAUA,MAAMkB,UAAU,GAAG,YAAY;IAC3Bb,OAAO,CAAC,IAAD,CAAP;IACA,MAAMP,UAAU,CAACE,IAAX,CAAgBmB,MAAhB,EAAN;EACH,CAHD;;EAKA,oBACI,QAAC,WAAD,CAAa,QAAb;IAAsB,KAAK,EAAE;MAAEnB,IAAF;MAAQC,SAAR;MAAmBiB,UAAnB;MAA+BZ;IAA/B,CAA7B;IAAA,UACKF;EADL;IAAA;IAAA;IAAA;EAAA,QADJ;AAKH,CAtCD;;IAAMD,Y;;KAAAA,Y;AAwCN,SAASD,OAAT,EAAkBC,YAAlB"},"metadata":{},"sourceType":"module"}