{"ast":null,"code":"var _jsxFileName = \"D:\\\\\\u6591\\u9A6C\\\\\\u524D\\u7AEFts\\\\\\u7535\\u5546\\u7F51\\u7AD9\\\\ecommerce-webapp\\\\src\\\\pages\\\\product\\\\product.js\",\n    _s = $RefreshSig$();\n\nimport './product.css'; // 导入产品页面的样式文件\n\nimport { useEffect, useState } from \"react\"; // 从 React 导入 useEffect 和 useState 钩子，用于管理组件状态和副作用\n\nimport { FakeStoreApi } from '../../services/fake-store-api'; // 从服务文件中导入 FakeStoreApi，用于获取产品数据\n\nimport { Link, useParams } from \"react-router-dom\"; // 导入 Link 和 useParams，用于路由处理\n\nimport { useCart } from \"../../context/cart\"; // 从购物车上下文中导入 useCart，用于添加商品到购物车\n// Product 组件用于显示特定产品的详细信息\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Product = () => {\n  _s();\n\n  const [loading, setLoading] = useState(true);\n  const [products, setProducts] = useState([]);\n  const [query] = useSearchParams();\n  const {\n    addToCart\n  } = useCart();\n  const [sortBy, setSortBy] = useState(''); // 排序字段\n\n  const [sortOrder, setSortOrder] = useState('asc'); // 排序顺序\n\n  const searchQuery = query.get('q');\n  useEffect(() => {\n    const fetchProducts = async () => {\n      setLoading(true);\n      const products = searchQuery ? await FakeStoreApi.fetchProductsBySearchQuery(searchQuery) : await FakeStoreApi.fetchAllProducts();\n      setProducts(products);\n      setLoading(false);\n    };\n\n    fetchProducts().catch(console.error);\n  }, [searchQuery]);\n\n  const handleSort = field => {\n    // 切换排序方式和顺序\n    if (sortBy === field) {\n      setSortOrder(prev => prev === 'asc' ? 'desc' : 'asc');\n    } else {\n      setSortBy(field);\n      setSortOrder('asc');\n    }\n  };\n\n  const sortedProducts = () => {\n    if (sortBy) {\n      return [...products].sort((a, b) => {\n        if (sortOrder === 'asc') {\n          return a[sortBy] > b[sortBy] ? 1 : -1;\n        } else {\n          return a[sortBy] < b[sortBy] ? 1 : -1;\n        }\n      });\n    }\n\n    return products; // 返回未排序的产品\n  };\n\n  if (!loading && searchQuery && !products.length) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"product py-2\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"details p-3\",\n          children: \"\\u6CA1\\u6709\\u627E\\u5230\\u5339\\u914D\\u60A8\\u67E5\\u8BE2\\u7684\\u4EA7\\u54C1\\u3002\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 13\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sortButtons\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => handleSort('price'),\n          children: \"\\u6309\\u4EF7\\u683C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => handleSort('rating'),\n          children: \"\\u6309\\u8BC4\\u4EF7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"products my-5\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid\",\n          children: loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"loader\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 29\n          }, this) : sortedProducts().map(product => /*#__PURE__*/_jsxDEV(Item, {\n            data: product,\n            addToCart: () => addToCart(product)\n          }, product.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 33\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 13\n    }, this)\n  }, void 0, false);\n};\n\n_s(Product, \"GHuMMNe79PCGoKw1jEBTWrPmsZk=\", true, function () {\n  return [useCart];\n});\n\n_c = Product;\nexport { Product }; // 导出 Product 组件\n\nvar _c;\n\n$RefreshReg$(_c, \"Product\");","map":{"version":3,"names":["useEffect","useState","FakeStoreApi","Link","useParams","useCart","Product","loading","setLoading","products","setProducts","query","useSearchParams","addToCart","sortBy","setSortBy","sortOrder","setSortOrder","searchQuery","get","fetchProducts","fetchProductsBySearchQuery","fetchAllProducts","catch","console","error","handleSort","field","prev","sortedProducts","sort","a","b","length","map","product","id"],"sources":["D:/斑马/前端ts/电商网站/ecommerce-webapp/src/pages/product/product.js"],"sourcesContent":["import './product.css' // 导入产品页面的样式文件\nimport { useEffect, useState } from \"react\" // 从 React 导入 useEffect 和 useState 钩子，用于管理组件状态和副作用\nimport { FakeStoreApi } from '../../services/fake-store-api' // 从服务文件中导入 FakeStoreApi，用于获取产品数据\nimport { Link, useParams } from \"react-router-dom\" // 导入 Link 和 useParams，用于路由处理\nimport { useCart } from \"../../context/cart\" // 从购物车上下文中导入 useCart，用于添加商品到购物车\n\n// Product 组件用于显示特定产品的详细信息\nconst Product = () => {\n    const [loading, setLoading] = useState(true);\n    const [products, setProducts] = useState([]);\n    const [query] = useSearchParams();\n    const { addToCart } = useCart();\n    \n    const [sortBy, setSortBy] = useState(''); // 排序字段\n    const [sortOrder, setSortOrder] = useState('asc'); // 排序顺序\n\n    const searchQuery = query.get('q');\n\n    useEffect(() => {\n        const fetchProducts = async () => {\n            setLoading(true);\n            const products = searchQuery ? \n                await FakeStoreApi.fetchProductsBySearchQuery(searchQuery) : \n                await FakeStoreApi.fetchAllProducts();\n            setProducts(products);\n            setLoading(false);\n        };\n        fetchProducts().catch(console.error);\n    }, [searchQuery]);\n\n    const handleSort = (field) => {\n        // 切换排序方式和顺序\n        if (sortBy === field) {\n            setSortOrder(prev => (prev === 'asc' ? 'desc' : 'asc'));\n        } else {\n            setSortBy(field);\n            setSortOrder('asc');\n        }\n    };\n\n    const sortedProducts = () => {\n        if (sortBy) {\n            return [...products].sort((a, b) => {\n                if (sortOrder === 'asc') {\n                    return a[sortBy] > b[sortBy] ? 1 : -1;\n                } else {\n                    return a[sortBy] < b[sortBy] ? 1 : -1;\n                }\n            });\n        }\n        return products; // 返回未排序的产品\n    };\n\n    if (!loading && searchQuery && !products.length) {\n        return (\n            <div className=\"container\">\n                <div className=\"product py-2\">\n                    <div className=\"details p-3\">没有找到匹配您查询的产品。</div>\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <>\n            <div className=\"container\">\n                <div className=\"sortButtons\">\n                    <button onClick={() => handleSort('price')}>按价格</button>\n                    <button onClick={() => handleSort('rating')}>按评价</button>\n                </div>\n                <div className=\"products my-5\">\n                    <div className=\"grid\">\n                        {loading ? (\n                            <div className=\"loader\" />\n                        ) : (\n                            sortedProducts().map((product) => (\n                                <Item key={product.id} data={product} addToCart={() => addToCart(product)} />\n                            ))\n                        )}\n                    </div>\n                </div>\n            </div>\n        </>\n    );\n};\n\nexport { Product } // 导出 Product 组件"],"mappings":"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"},"metadata":{},"sourceType":"module"}