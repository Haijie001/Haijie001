{"ast":null,"code":"var _jsxFileName = \"D:\\\\\\u6591\\u9A6C\\\\\\u524D\\u7AEFts\\\\\\u7535\\u5546\\u7F51\\u7AD9\\\\ecommerce-webapp\\\\src\\\\pages\\\\products\\\\products.js\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState } from \"react\"; // 导入 React 钩子\n\nimport { FakeStoreApi } from '../../services/fake-store-api'; // 导入 FakeStoreApi\n\nimport { useSearchParams } from \"react-router-dom\"; // 导入 URL 查询参数钩子\n\nimport { Item } from \"../../components/item\"; // 导入产品项组件\n\nimport { useCart } from \"../../context/cart\"; // 导入购物车上下文\n// Products 组件用于显示产品列表，并支持通过查询参数进行搜索\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Products = () => {\n  _s();\n\n  const [loading, setLoading] = useState(true); // 加载状态\n\n  const [products, setProducts] = useState([]); // 产品列表\n\n  const [query] = useSearchParams(); // 获取 URL 查询参数\n\n  const {\n    addToCart\n  } = useCart(); // 获取添加到购物车的方法\n\n  const searchQuery = query.get('q'); // 获取搜索关键字 'q'\n\n  const [sortOrder, setSortOrder] = useState({\n    key: '',\n    direction: 'asc'\n  }); // 排序状态\n  // 获取产品数据\n\n  useEffect(() => {\n    const fetchProducts = async () => {\n      setLoading(true);\n      const products = searchQuery ? await FakeStoreApi.fetchProductsBySearchQuery(searchQuery) : await FakeStoreApi.fetchAllProducts();\n      setProducts(products);\n      setLoading(false);\n    };\n\n    fetchProducts().catch(console.error);\n  }, [searchQuery]); // 排序函数\n\n  const sortProducts = key => {\n    const direction = sortOrder.key === key && sortOrder.direction === 'asc' ? 'desc' : 'asc'; // 切换排序方向\n\n    const sortedProducts = [...products].sort((a, b) => {\n      if (direction === 'asc') {\n        return a[key] > b[key] ? 1 : -1;\n      } else {\n        return a[key] < b[key] ? 1 : -1;\n      }\n    });\n    setSortOrder({\n      key,\n      direction\n    }); // 更新排序状态\n\n    setProducts(sortedProducts); // 更新产品列表\n  }; // 如果没有匹配的产品，显示未找到产品的消息\n\n\n  if (!loading && searchQuery && !products.length) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"product py-2\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"details p-3\",\n          children: \"No products found matching your query.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 49,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 13\n    }, this);\n  } // 返回产品列表页面的 JSX 结构\n\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"sort-buttons my-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => sortProducts('price'),\n        children: [\"\\u6309\\u4EF7\\u683C \", sortOrder.key === 'price' && sortOrder.direction === 'asc' ? '升序' : '降序']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => sortProducts('rating'),\n        children: [\"\\u6309\\u8BC4\\u4EF7 \", sortOrder.key === 'rating' && sortOrder.direction === 'asc' ? '升序' : '降序']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"products my-5\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid\",\n        children: loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"loader\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 25\n        }, this) : products.map(product => /*#__PURE__*/_jsxDEV(Item, {\n          data: product,\n          addToCart: () => addToCart(product)\n        }, product.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 29\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Products, \"mLoj0DiqTs5hm1WULm6WNvsJIPg=\", false, function () {\n  return [useSearchParams, useCart];\n});\n\n_c = Products;\nexport { Products }; // 导出 Products 组件\n\nvar _c;\n\n$RefreshReg$(_c, \"Products\");","map":{"version":3,"names":["useEffect","useState","FakeStoreApi","useSearchParams","Item","useCart","Products","loading","setLoading","products","setProducts","query","addToCart","searchQuery","get","sortOrder","setSortOrder","key","direction","fetchProducts","fetchProductsBySearchQuery","fetchAllProducts","catch","console","error","sortProducts","sortedProducts","sort","a","b","length","map","product","id"],"sources":["D:/斑马/前端ts/电商网站/ecommerce-webapp/src/pages/products/products.js"],"sourcesContent":["import { useEffect, useState } from \"react\"; // 导入 React 钩子\nimport { FakeStoreApi } from '../../services/fake-store-api'; // 导入 FakeStoreApi\nimport { useSearchParams } from \"react-router-dom\"; // 导入 URL 查询参数钩子\nimport { Item } from \"../../components/item\"; // 导入产品项组件\nimport { useCart } from \"../../context/cart\"; // 导入购物车上下文\n\n// Products 组件用于显示产品列表，并支持通过查询参数进行搜索\nconst Products = () => {\n    const [loading, setLoading] = useState(true); // 加载状态\n    const [products, setProducts] = useState([]); // 产品列表\n    const [query] = useSearchParams(); // 获取 URL 查询参数\n    const { addToCart } = useCart(); // 获取添加到购物车的方法\n\n    const searchQuery = query.get('q'); // 获取搜索关键字 'q'\n    const [sortOrder, setSortOrder] = useState({ key: '', direction: 'asc' }); // 排序状态\n\n    // 获取产品数据\n    useEffect(() => {\n        const fetchProducts = async () => {\n            setLoading(true);\n            const products = searchQuery \n                ? await FakeStoreApi.fetchProductsBySearchQuery(searchQuery) \n                : await FakeStoreApi.fetchAllProducts();\n            setProducts(products);\n            setLoading(false);\n        };\n        fetchProducts().catch(console.error);\n    }, [searchQuery]);\n\n    // 排序函数\n    const sortProducts = (key) => {\n        const direction = sortOrder.key === key && sortOrder.direction === 'asc' ? 'desc' : 'asc'; // 切换排序方向\n        const sortedProducts = [...products].sort((a, b) => {\n            if (direction === 'asc') {\n                return a[key] > b[key] ? 1 : -1;\n            } else {\n                return a[key] < b[key] ? 1 : -1;\n            }\n        });\n        setSortOrder({ key, direction }); // 更新排序状态\n        setProducts(sortedProducts); // 更新产品列表\n    };\n\n    // 如果没有匹配的产品，显示未找到产品的消息\n    if (!loading && searchQuery && !products.length) {\n        return (\n            <div className=\"container\">\n                <div className=\"product py-2\">\n                    <div className=\"details p-3\">No products found matching your query.</div>\n                </div>\n            </div>\n        );\n    }\n\n    // 返回产品列表页面的 JSX 结构\n    return (\n        <div className=\"container\">\n            <div className=\"sort-buttons my-3\">\n                <button onClick={() => sortProducts('price')}>\n                    按价格 {sortOrder.key === 'price' && sortOrder.direction === 'asc' ? '升序' : '降序'}\n                </button>\n                <button onClick={() => sortProducts('rating')}>\n                    按评价 {sortOrder.key === 'rating' && sortOrder.direction === 'asc' ? '升序' : '降序'}\n                </button>\n            </div>\n            <div className=\"products my-5\">\n                <div className=\"grid\">\n                    {loading ? (\n                        <div className=\"loader\" />\n                    ) : (\n                        products.map((product) => (\n                            <Item key={product.id} data={product} addToCart={() => addToCart(product)} />\n                        ))\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport { Products }; // 导出 Products 组件"],"mappings":"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"},"metadata":{},"sourceType":"module"}